# План улучшений Crypto Portfolio Manager

## Обзор

После анализа проекта были выявлены области, требующие улучшения. Ниже представлен подробный план действий по устранению недостатков и улучшению функциональности.

## 1. Улучшение системы конфигурации

### Проблема
Жестко заданные параметры в коде (таймауты, интервалы обновления)

### Решение
Создать систему конфигурации на основе переменных окружения и файла .env

### Задачи
1. Создать файл конфигурации `app/core/config.py`
2. Перенести все жестко заданные параметры в конфигурацию
3. Добавить поддержку переменных окружения
4. Создать пример файла .env

## 2. Улучшение обработки ошибок и логирования

### Проблема
Минимальная обработка ошибок, отсутствие логирования

### Решение
Реализовать полноценную систему логирования и улучшить обработку ошибок

### Задачи
1. Добавить модуль логирования `app/core/logging.py`
2. Заменить принты на логирование в модуле цен `app/adapters/prices.py`
3. Улучшить обработку ошибок в сервисах
4. Добавить логирование в ключевых точках приложения

## 3. Рефакторинг системы уведомлений

### Проблема
Система уведомлений отключена, использует глобальные переменные

### Решение
Рефакторинг системы уведомлений с использованием классов и правильной интеграцией с NiceGUI

### Задачи
1. Пересмотреть архитектуру системы уведомлений
2. Убрать использование глобальных переменных
3. Правильно интегрировать с NiceGUI (используя его event loop)
4. Включить систему уведомлений в основное приложение

## 4. Реализация системы графиков

### Проблема
Графики закомментированы и не реализованы

### Решение
Реализовать графики с использованием Plotly

### Задачи
1. Раскомментировать и доработать `app/ui/charts.py`
2. Интегрировать графики во вкладку "Графики"
3. Добавить различные типы графиков (распределение портфеля, временная шкала сделок и т.д.)

## 5. Улучшение системы кэширования

### Проблема
Использование глобальных переменных для кэша

### Решение
Реализовать кэш как класс с правильной синхронизацией

### Задачи
1. Создать класс CacheManager
2. Заменить глобальные переменные на экземпляр класса
3. Добавить механизмы синхронизации при необходимости

## 6. Добавление тестов

### Проблема
Отсутствие автоматических тестов

### Решение
Добавить модульные тесты для ключевой функциональности

### Задачи
1. Создать директорию `tests/`
2. Добавить тесты для FIFO расчетов
3. Добавить тесты для сервисов
4. Добавить тесты для адаптера цен

## 7. Документация

### Проблема
Недостаточная документация кода

### Решение
Добавить документацию к ключевым модулям и функциям

### Задачи
1. Добавить docstrings к основным функциям
2. Создать документацию по API
3. Добавить комментарии к сложным алгоритмам

## Приоритеты реализации

### Высокий приоритет
- Улучшение конфигурации
- Улучшение обработки ошибок и логирования
- Рефакторинг системы кэширования

### Средний приоритет
- Реализация системы уведомлений
- Добавление графиков
- Документация

### Низкий приоритет
- Добавление тестов
- Дополнительные улучшения UI

Этот план позволит постепенно улучшить проект, начиная с самых критичных аспектов и заканчивая дополнительными функциями.