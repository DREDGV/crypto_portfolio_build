# HANDOFF –¥–ª—è Cursor ‚Äî Crypto Portfolio Manager

## 1) TL;DR / –ó–∞—á–µ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ

–õ–æ–∫–∞–ª—å–Ω—ã–π (–æ—Ñ–ª–∞–π–Ω-–¥—Ä—É–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–π) –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç —É—á—ë—Ç–∞ –∫—Ä–∏–ø—Ç–æ–ø–æ—Ä—Ç—Ñ–µ–ª—è:

- —Ö—Ä–∞–Ω–∏—Ç –≤—Å–µ —Å–¥–µ–ª–∫–∏ (–ø–æ–∫—É–ø–∫–∞/–ø—Ä–æ–¥–∞–∂–∞/–ø–µ—Ä–µ–≤–æ–¥—ã/–æ–±–º–µ–Ω—ã) + –∑–∞–º–µ—Ç–∫–∏/–∏—Å—Ç–æ—á–Ω–∏–∫/—Å—Ç—Ä–∞—Ç–µ–≥–∏—é;
- —Å—á–∏—Ç–∞–µ—Ç –ø–æ–∑–∏—Ü–∏–∏ –ø–æ FIFO, —Å—Ä–µ–¥–Ω—é—é —Ü–µ–Ω—É, PnL (–Ω–µ—Ä–µ–∞–ª–∏–∑. –∏ —Ä–µ–∞–ª–∏–∑.);
- –ø–æ–¥—Ö–≤–∞—Ç—ã–≤–∞–µ—Ç —Ç–µ–∫—É—â–∏–µ —Ü–µ–Ω—ã (CoinGecko Simple Price);
- —É–¥–æ–±–Ω—ã–π UI —Å –≤–∫–ª–∞–¥–∫–∞–º–∏, —Ñ–∏–ª—å—Ç—Ä–∞–º–∏, —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ–º, CSV-—ç–∫—Å–ø–æ—Ä—Ç–æ–º.

**–¶–µ–ª—å** ‚Äî –±—ã—Å—Ç—Ä—ã–π –∫–æ–Ω—Ç—Ä–æ–ª—å, –ø—Ä–∏–Ω—è—Ç–∏–µ —Ä–µ—à–µ–Ω–∏–π –∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ ¬´–ø—Ä–æ–ø—É—â–µ–Ω–Ω–æ–π –ø—Ä–∏–±—ã–ª–∏¬ª.

**–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è**: –±–µ–∑ –ø–ª–∞—Ç–Ω—ã—Ö —Å–µ—Ä–≤–∏—Å–æ–≤, –±–µ–∑ —Å–µ—Ä–≤–µ—Ä–æ–≤, –≤—Å—ë –ª–æ–∫–∞–ª—å–Ω–æ (Windows 11, Python 3.13).

## 2) –¢–µ–∫—É—â–∏–π —Å—Ç–µ–∫ –∏ –∑–∞–ø—É—Å–∫

**Python 3.13**, NiceGUI (–≤–µ–±-UI –ª–æ–∫–∞–ª—å–Ω–æ), SQLite + SQLModel, httpx, python-dotenv.

**–î–æ–ø. –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å –≤ requirements.txt**: nicegui, sqlmodel, sqlalchemy, aiosqlite, pydantic>=2, httpx, python-dotenv.

**–ó–∞–ø—É—Å–∫ (Windows)**:
- –ü–µ—Ä–≤—ã–π —Ä–∞–∑: `setup_once.bat` (–≤–∏—Ä—Ç—É–∞–ª–∫–∞ + –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏)
- –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞ —Å –∞–≤—Ç–æ-–ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–æ–π: `run_dev.bat` (ENV DEV=1)
- –ü—Ä–æ–¥: `run_prod.bat`
- –û—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è `http://127.0.0.1:8080`

**.env –ø—Ä–∏–º–µ—Ä (–Ω–µ –æ–±—è–∑–∞—Ç–µ–ª–µ–Ω)**:
```
APP_PORT=8080
REPORT_CURRENCY=USD
LOCAL_TIMEZONE=Europe/Moscow
```

## 3) –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞ (–ø–∞–ø–∫–∏/—Ñ–∞–π–ª—ã)

```
app/
  main.py                 # —Ç–æ—á–∫–∏ –≤—Ö–æ–¥–∞ NiceGUI –∏ —Ä–æ—É—Ç—ã
  ui/pages.py             # –≤—Å–µ —ç–∫—Ä–∞–Ω—ã –∏ –≤–∫–ª–∞–¥–∫–∏ (Overview/Positions/Transactions)
  core/models.py          # –º–æ–¥–µ–ª–∏ SQLModel –∏ DTO
  core/services.py        # –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞: CRUD, FIFO, PnL, —ç–∫—Å–ø–æ—Ä—Ç CSV
  adapters/prices.py      # CoinGecko Simple Price (+ –∫—ç—à 60—Å)
  storage/db.py           # SQLite/SQLModel init (data/portfolio.db)
data/
  backups/                # –±—ç–∫–∞–ø—ã –ë–î
  exports/                # CSV-—ç–∫—Å–ø–æ—Ä—Ç
scripts (–≤ –∫–æ—Ä–Ω–µ)
  setup_once.bat / run_dev.bat / run_prod.bat
.vscode/launch.json       # –ø—Ä–æ—Ñ–∏–ª—å –∑–∞–ø—É—Å–∫–∞ (–¥–ª—è Cursor/VS Code)
```

## 4) –î–∞–Ω–Ω—ã–µ –∏ –±–∏–∑–Ω–µ—Å-–ø—Ä–∞–≤–∏–ª–∞

### –ú–æ–¥–µ–ª—å Transaction (SQLModel)

**–ü–æ–ª—è**:
- `id: int PK`
- `coin: str` (–Ω–∞–ø—Ä–∏–º–µ—Ä, BTC, ETH; —Ö—Ä–∞–Ω–∏–º –≤ UPPER)
- `type: str` ‚Äî –æ–¥–Ω–æ –∏–∑: buy, sell, exchange_in, exchange_out, deposit, withdrawal
- `quantity: float` (–ø–ª–∞–Ω: –ø–µ—Ä–µ–≤–µ—Å—Ç–∏ –Ω–∞ Decimal)
- `price: float` (–≤ –≤–∞–ª—é—Ç–µ –æ—Ç—á—ë—Ç–∞; –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é USD)
- `ts_utc: datetime` (–∞–≤—Ç–æ now UTC)
- `strategy: str` ‚Äî long, mid, short, scalp
- `source: str | None` ‚Äî –±–∏—Ä–∂–∞/–∫–æ—à–µ–ª—ë–∫
- `notes: str | None`

DTO –¥–ª—è –≤–≤–æ–¥–∞: `TransactionIn` (—Ç–µ –∂–µ –ø–æ–ª—è, –∫—Ä–æ–º–µ id/ts).

### FIFO –∏ PnL

- **–ö–ª—é—á –ª–æ—Ç–∞**: `(coin, strategy)` ‚Äî –ø–æ–∑–∏—Ü–∏–∏ —Ä–∞–∑–¥–µ–ª—å–Ω–æ –ø–æ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏, —á—Ç–æ–±—ã —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–æ–≤–∞—Ç—å —Ç–≤–æ–µ–º—É —Å—Ü–µ–Ω–∞—Ä–∏—é ¬´–Ω–µ—Å–∫–æ–ª—å–∫–æ –∫–æ—Ä–∑–∏–Ω¬ª.
- **–ü—Ä–∏—Ö–æ–¥**: buy / exchange_in / deposit ‚Äî –¥–æ–±–∞–≤–ª—è–µ—Ç –ª–æ—Ç—ã `{qty, price}`.
- **–†–∞—Å—Ö–æ–¥**: sell / exchange_out / withdrawal ‚Äî —Å–ø–∏—Å—ã–≤–∞–µ—Ç –∏–∑ –æ—á–µ—Ä–µ–¥–∏ FIFO, —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–π PnL = `qty * (sell_price - lot_price)`.
- **–ü–æ–∑–∏—Ü–∏—è**: —Å—É–º–º–∞ –æ—Å—Ç–∞—Ç–∫–æ–≤ –ª–æ—Ç–æ–≤; `avg_cost = cost_basis / qty`.
- **–ù–µ—Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–π PnL**: `(current_price * qty) - cost_basis`, % = `(price - avg_cost)/avg_cost * 100`.
- **–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–π PnL** –Ω–∞–∫–∞–ø–ª–∏–≤–∞–µ—Ç—Å—è –ø–æ –∫–ª—é—á—É `(coin, strategy)`.

## 5) –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Ü–µ–Ω (CoinGecko)

**adapters/prices.py**:
- —ç–Ω–¥–ø–æ–∏–Ω—Ç: `GET /api/v3/simple/price?ids={id}&vs_currencies={quote}`
- –∫–∞—Ä—Ç–∞ —Ç–∏–∫–µ—Ä–æ–≤ ‚Üí id (BTC->bitcoin, XLM->stellar, ‚Ä¶)
- –∫—ç—à –Ω–∞ 60 —Å–µ–∫—É–Ω–¥ –≤ –ø–∞–º—è—Ç–∏, —Ç–∞–π–º–∞—É—Ç –∫–ª–∏–µ–Ω—Ç–∞ 8—Å, –æ—à–∏–±–∫–∞ ‚Üí None (UI –ø–æ–∫–∞–∂–µ—Ç 0).

## 6) UI (NiceGUI)

**–í–∫–ª–∞–¥–∫–∏**:
- **Overview** ‚Äî —Å–≤–æ–¥–Ω—ã–µ —á–∏–ø—ã (total value, unrealized PnL, realized PnL) + —Ç–∞–±–ª–∏—Ü–∞ –ø–æ–∑–∏—Ü–∏–π (FIFO + —Ü–µ–Ω—ã)
- **Positions** ‚Äî —Ç–µ –∂–µ –ø–æ–∑–∏—Ü–∏–∏, –∫–Ω–æ–ø–∫–∞ ¬´–≠–∫—Å–ø–æ—Ä—Ç –ø–æ–∑–∏—Ü–∏–π (CSV)¬ª
- **Transactions** ‚Äî —Ñ–æ—Ä–º–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è —Å–¥–µ–ª–∫–∏ (–≤—Å–µ –ø–æ–ª—è, autocomplete=off, —á—Ç–æ–±—ã Edge –Ω–µ –æ—Ç–∫—Ä—ã–≤–∞–ª ¬´–∫–æ—à–µ–ª—ë–∫¬ª), —Ç–∞–±–ª–∏—Ü–∞ —Å–æ —Å–¥–µ–ª–∫–∞–º–∏ + ‚úèÔ∏è —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ üóëÔ∏è —É–¥–∞–ª–µ–Ω–∏–µ, ¬´–≠–∫—Å–ø–æ—Ä—Ç —Å–¥–µ–ª–æ–∫ (CSV)¬ª

**–ì–ª–æ–±–∞–ª—å–Ω—ã–µ —Ñ–∏–ª—å—Ç—Ä—ã** (–Ω–∞–¥ –≤–∫–ª–∞–¥–∫–∞–º–∏): –ø–æ –º–æ–Ω–µ—Ç–µ –∏ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏; –ø—Ä–∏–º–µ–Ω—è—é—Ç—Å—è –∫ –ø–æ–∑–∏—Ü–∏—è–º –∏ —Å–¥–µ–ª–∫–∞–º.

## 7) –ß—Ç–æ —É–∂–µ —Ä–∞–±–æ—Ç–∞–µ—Ç

- ‚úÖ CRUD —Å–¥–µ–ª–æ–∫ (create/list/update/delete)
- ‚úÖ FIFO-–∞–≥—Ä–µ–≥–∞—Ü–∏—è –≤ –ø–æ–∑–∏—Ü–∏–∏ –ø–æ (coin, strategy)
- ‚úÖ –ù–µ—Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–π/—Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–π PnL, —Å—Ä–µ–¥–Ω—è—è —Ü–µ–Ω–∞, —Ç–µ–∫—É—â–∞—è —Å—Ç–æ–∏–º–æ—Å—Ç—å
- ‚úÖ –ü–æ–¥—Ç—è–∂–∫–∞ —Ü–µ–Ω —Å CoinGecko (—Å –∫—ç—à–µ–º)
- ‚úÖ –≠–∫—Å–ø–æ—Ä—Ç CSV: transactions_*.csv, positions_*.csv
- ‚úÖ –ü—Ä–æ—Å—Ç—ã–µ –±—ç–∫–∞–ø—ã –ë–î (–∫–æ–ø–∏—è data/portfolio.db –≤ data/backups ‚Äî –¥–æ—Å—Ç—É–ø–Ω–æ –≤ –∫–æ–¥–µ, –∫–Ω–æ–ø–∫—É –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å)
- ‚úÖ –û—Ç–∫–ª—é—á–µ–Ω–æ –∞–≤—Ç–æ–∑–∞–ø–æ–ª–Ω–µ–Ω–∏–µ –ø–æ–ª–µ–π –≤–≤–æ–¥–∞

**–ù–µ–¥–∞–≤–Ω—è—è –ø—Ä–∞–≤–∫–∞**: –¥–æ–±–∞–≤–ª–µ–Ω—ã —Ñ—É–Ω–∫—Ü–∏–∏ `export_transactions_csv` –∏ `export_positions_csv` –≤ `core/services.py` (—Ä–∞–Ω—å—à–µ –∏—Ö –Ω–µ–¥–æ—Å—Ç–∞–≤–∞–ª–æ; —Ç–µ–ø–µ—Ä—å –æ–∫).

## 8) –ü–ª–∞–Ω—ã –∏ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç—ã (–ø—Ä–µ–¥–ª–∞–≥–∞–µ–º–∞—è –¥–æ—Ä–æ–∂–Ω–∞—è –∫–∞—Ä—Ç–∞)

### –ò—Ç–µ—Ä–∞—Ü–∏—è 1 ‚Äî ¬´–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ —Ñ–∏—á–∏¬ª

**–ê–ª–µ—Ä—Ç—ã (–ª–æ–∫–∞–ª—å–Ω–æ)**:
- –ø—Ä–∞–≤–∏–ª–∞: –ø–æ —Ü–µ–Ω–µ, –ø–æ % –∏–∑–º–µ–Ω–µ–Ω–∏—è, –ø–æ –Ω–µ—Ä–µ–∞–ª–∏–∑. PnL;
- –ø–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏–π –æ–ø—Ä–æ—Å (APScheduler —É–∂–µ –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—è—Ö) + –≤—Å–ø–ª—ã–≤–∞—é—â–µ–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –≤ UI;
- (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) TelegramWebhook/–±–æ—Ç (–µ—Å–ª–∏ –∑–∞—Ö–æ—á–µ—à—å, –Ω–æ –º–æ–∂–Ω–æ –æ—Ç–ª–æ–∂–∏—Ç—å).

**–ê–Ω–∞–ª–∏—Ç–∏–∫–∞**:
- –º–∏–Ω–∏-–≥—Ä–∞—Ñ–∏–∫–∏ —Ü–µ–Ω—ã/—Å—Ç–æ–∏–º–æ—Å—Ç–∏ –ø–æ–∑–∏—Ü–∏–∏ (7–¥/30–¥), PnL –ø–æ –ø–µ—Ä–∏–æ–¥–∞–º;
- –∫—ç—à –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏—Ö —Ü–µ–Ω (—ç–∫–æ–Ω–æ–º–∏–º –ª–∏–º–∏—Ç—ã CoinGecko).

**–ò–º–ø–æ—Ä—Ç CSV**:
- –º–∞–ø–ø–∏–Ω–≥ –∫–æ–ª–æ–Ω–æ–∫ + –ø—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä;
- –±–∞–∑–æ–≤–∞—è –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è (–º—É–ª—å—Ç. –∑–∞–ø—è—Ç—ã–µ, –ª–æ–∫–∞–ª–∏).

**–°–æ—Ö—Ä–∞–Ω—ë–Ω–Ω—ã–µ —Ñ–∏–ª—å—Ç—Ä—ã/–≤–∏–¥—ã** (–±—ã—Å—Ç—Ä—ã–π –¥–æ—Å—Ç—É–ø).

### –ò—Ç–µ—Ä–∞—Ü–∏—è 2 ‚Äî ¬´—Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø–æ—Ä—Ç—Ñ–µ–ª—è¬ª

**–ú—É–ª—å—Ç–∏–ø–æ—Ä—Ç—Ñ–µ–ª–∏**: —Ç–∞–±–ª–∏—Ü–∞ portfolio + FK –≤ Transaction, –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –∏–º–µ—Ç—å ¬´–î–æ–ª–≥–æ—Å—Ä–æ—á–Ω—ã–π¬ª, ¬´–°—Ä–µ–¥–Ω–∏–π¬ª, ¬´–°–∫–∞–ª—å–ø–∏–Ω–≥¬ª –∫–∞–∫ —Ä–∞–∑–Ω—ã–µ –ø–æ—Ä—Ç—Ñ–µ–ª–∏ (—Å—Ç—Ä–∞—Ç–µ–≥–∏—è –æ—Å—Ç–∞—ë—Ç—Å—è, –Ω–æ –ø–æ—Ä—Ç—Ñ–µ–ª—å ‚Äî –Ω–∞–¥—Å—Ç—Ä–æ–π–∫–∞). –ú–∏–≥—Ä–∞—Ü–∏—è: –≤—Å–µ –∑–∞–ø–∏—Å–∏ ‚Üí default.

**–ö–∞–ø–∏—Ç–∞–ª-–º–µ–Ω–µ–¥–∂–º–µ–Ω—Ç** (—Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ ¬´–ª–µ—Å—Ç–Ω–∏—Ü–µ –∑–∞–∫—É–ø–æ–∫¬ª):
- –∫–æ–Ω—Ñ–∏–≥–∏ %/—Å—Ç—É–ø–µ–Ω–µ–π;
- –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä —Å—Ç—Ä–∞—Ö–∞/–∂–∞–¥–Ω–æ—Å—Ç–∏ (–±–µ—Å–ø–ª–∞—Ç–Ω—ã–π API) –∫–∞–∫ —Å–∏–≥–Ω–∞–ª (–∞–≥—Ä–µ–≥–∏—Ä—É–µ–º, –Ω–µ —Ç–æ—Ä–≥—É–µ–º –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏).

### –ò—Ç–µ—Ä–∞—Ü–∏—è 3 ‚Äî ¬´–∫–∞—á–µ—Å—Ç–≤–æ –∏ –¥–æ–ª–≥–æ–≤–µ—á–Ω–æ—Å—Ç—å¬ª

**–¢–æ—á–Ω–æ—Å—Ç—å**: –ø–µ—Ä–µ–π—Ç–∏ c float –Ω–∞ Decimal (Pydantic + SQLModel), –µ–¥–∏–Ω—ã–π quantize.

**–¢–µ—Å—Ç—ã** (pytest): —é–Ω–∏—Ç –¥–ª—è FIFO/PNL, –∞–¥–∞–ø—Ç–µ—Ä–∞ —Ü–µ–Ω (–º–æ–∫).

**–≠–∫—Å–ø–æ—Ä—Ç/–∏–º–ø–æ—Ä—Ç –±—ç–∫–∞–ø–æ–≤** (zip —Å –ë–î –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏).

**–£–ø–∞–∫–æ–≤–∫–∞** (PyInstaller) ‚Üí exe ¬´–ø–æ—Ä—Ç–∞—Ç–∏–≤–Ω–æ¬ª –ø–æ –∂–µ–ª–∞–Ω–∏—é.

## 9) –†–µ—à–µ–Ω–∏—è –ø–æ –¥–∏–∑–∞–π–Ω—É –∏ –∫–æ–Ω–≤–µ–Ω—Ü–∏–∏

- –¢–∏–∫–µ—Ä—ã –≤—Å–µ–≥–¥–∞ UPPER (`.upper().strip()` –ø—Ä–∏ –≤–≤–æ–¥–µ)
- –°—Ç—Ä–∞—Ç–µ–≥–∏–∏ –∏ —Ç–∏–ø—ã ‚Äî –∏–∑ —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ —Å–ø–∏—Å–∫–∞
- –í—Ä–µ–º—è –≤ –ë–î ‚Äî UTC; –≤ UI ‚Äî –ª–æ–∫–∞–ª—å–Ω–æ–µ (—Ñ–æ—Ä–º–∞—Ç `'%Y-%m-%d %H:%M:%S'`)
- –ß–∏—Å–ª–∞: –ø–æ–∫–∞ float (–ø–µ—Ä–µ—Ö–æ–¥ –Ω–∞ Decimal –≤ –∏—Ç–µ—Ä–∞—Ü–∏–∏ 3)
- –ò–∑ UI –≤—ã–∫–ª—é—á–µ–Ω–æ autocomplete (Edge Wallet –Ω–µ –º–µ—à–∞–µ—Ç)
- –†–æ—É—Ç–∏–Ω–≥ NiceGUI: `/#/portfolio`, –≤–∫–ª–∞–¥–∫–∏ –≤–Ω—É—Ç—Ä–∏ –æ–¥–Ω–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü—ã

## 10) –ò–∑–≤–µ—Å—Ç–Ω—ã–µ –≥—Ä–∞–±–ª–∏ (—É—á—Ç–µ–Ω–æ)

- **ImportError** –∏–∑-–∑–∞ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏—è —Ñ—É–Ω–∫—Ü–∏–π —ç–∫—Å–ø–æ—Ä—Ç–∞ ‚Äî –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ (–ø—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ –≤ –ø—Ä–æ–µ–∫—Ç–µ –µ—Å—Ç—å `export_transactions_csv` –∏ `export_positions_csv`)
- **Edge Wallet –∞–≤—Ç–æ–∑–∞–ø–æ–ª–Ω–µ–Ω–∏–µ** ‚Äî —Ä–µ—à–µ–Ω–æ `autocomplete=off`
- **–í–µ—Ä—Å–∏–∏ Python 3.13 + SQLModel + Pydantic v2** ‚Äî –≤—Å—ë —Å–æ–≤–º–µ—Å—Ç–∏–º–æ (–º—ã –∏—Å–ø–æ–ª—å–∑—É–µ–º –∞–∫—Ç—É–∞–ª—å–Ω—ã–µ –ø–∞–∫–µ—Ç—ã)

## 11) –ß—Ç–æ –Ω—É–∂–Ω–æ Cursor –Ω–∞ —Å—Ç–∞—Ä—Ç–µ

1. –ü–æ–¥—Ç—è–Ω—É—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –∏ –∑–∞–ø—É—Å—Ç–∏—Ç—å `run_dev.bat` (–∏–ª–∏ —á–µ—Ä–µ–∑ `python -m app.main` —Å ENV DEV=1)
2. –ü—Ä–æ–π—Ç–∏—Å—å –ø–æ —Ñ–∞–π–ª–∞–º:
   - `app/core/services.py` ‚Äî –ø–æ–Ω—è—Ç—å FIFO/—ç–∫—Å–ø–æ—Ä—Ç, —Ç–æ—á–∫–∏ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è
   - `app/ui/pages.py` ‚Äî –≥–¥–µ –¥–æ–±–∞–≤–ª—è—Ç—å –≤–∫–ª–∞–¥–∫–∏ ¬´Alerts¬ª, ¬´Analytics¬ª, ¬´Import CSV¬ª
   - `app/adapters/prices.py` ‚Äî –¥–æ—Ä–∞–±–æ—Ç–∞—Ç—å –∫—ç—à/—Ñ–æ–ª–±—ç–∫–∏/–º—É–ª—å—Ç–∏–≤–∞–ª—é—Ç–Ω–æ—Å—Ç—å
3. –°–æ–≥–ª–∞—Å–æ–≤–∞—Ç—å –¥–æ—Ä–æ–∂–Ω—É—é –∫–∞—Ä—Ç—É (—Å–º. –ø.8) –∏ –±—Ä–∞—Ç—å –∑–∞–¥–∞—á–∏ –ø–æ –ø–æ—Ä—è–¥–∫—É

## 12) –ú–∏–Ω–∏-–±—ç–∫–ª–æ–≥ –∑–∞–¥–∞—á (–≥–æ—Ç–æ–≤—ã–µ —Ñ–æ—Ä–º—É–ª–∏—Ä–æ–≤–∫–∏)

### Alerts
–ú–æ–¥–µ–ª—å `AlertRule` (id, coin, strategy?, kind: price|unreal_pct|unreal_abs, operator, threshold, active, last_trigger_at), –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫ –ø—Ä–æ–≤–µ—Ä–∫–∏ –∫–∞–∂–¥—ã–µ N —Å–µ–∫—É–Ω–¥, UI CRUD + —Ç–æ—Å—Ç-–Ω–æ—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏.

### Analytics
–ö–æ–º–ø–æ–Ω–µ–Ω—Ç –≥—Ä–∞—Ñ–∏–∫–∞ (NiceGUI: Plotly/Highcharts) –¥–ª—è —Å—Ç–æ–∏–º–æ—Å—Ç–∏ –ø–æ—Ä—Ç—Ñ–µ–ª—è, PnL –ø–æ –ø–µ—Ä–∏–æ–¥–∞–º; —Å–µ—Ä–≤–∏—Å `history_service.py` (–∞–≥—Ä–µ–≥–∞—Ü–∏—è –¥–Ω–µ–≤–Ω—ã—Ö —Å—Ä–µ–∑–æ–≤).

### Import CSV
–ó–∞–≥—Ä—É–∑–∫–∞ —Ñ–∞–π–ª–∞, —Å–æ–ø–æ—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –∫–æ–ª–æ–Ω–æ–∫ (coin, type, qty, price, ts, strategy, source, notes), dry-run, –∑–∞–ø–∏—Å—å –ø–∞—á–∫–æ–π.

### Multi-portfolio
–¢–∞–±–ª–∏—Ü–∞ `Portfolio(id, name)`, FK –≤ `Transaction.portfolio_id`, —Å–µ–ª–µ–∫—Ç–æ—Ä –∞–∫—Ç–∏–≤–Ω–æ–≥–æ –ø–æ—Ä—Ç—Ñ–µ–ª—è –≤ —à–∞–ø–∫–µ, –º–∏–≥—Ä–∞—Ü–∏—è –≤ default.

### Decimal
–ü–µ—Ä–µ—Ö–æ–¥ –∏ –º–∏–≥—Ä–∞—Ü–∏—è, –µ–¥–∏–Ω—ã–π —Å–ª–æ–π —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è.

### –¢–µ—Å—Ç—ã
–Æ–Ω–∏—Ç—ã –Ω–∞ FIFO, —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—é realized/unrealized PnL; –º–æ–∫ httpx.
