"""
–®–∞–≥ 2: –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–æ–ª–Ω–æ–≥–æ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–∞ –≤–≤–æ–¥–∞ —Å–¥–µ–ª–æ–∫
–ù–æ–≤—ã–π –¥–∏–∑–∞–π–Ω + –ü–æ–ª–Ω—ã–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª –≤–≤–æ–¥–∞ —Å –∞–≤—Ç–æ–¥–æ–ø–æ–ª–Ω–µ–Ω–∏–µ–º –∏ –∫–Ω–æ–ø–∫–æ–π "—Ç–µ–∫—É—â–∞—è —Ü–µ–Ω–∞"
"""

import os
import sys
from pathlib import Path

# –î–æ–±–∞–≤–ª—è–µ–º –∫–æ—Ä–Ω–µ–≤—É—é –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é –≤ –ø—É—Ç—å
sys.path.append(str(Path(__file__).parent.parent))

from nicegui import ui
from app.storage.db import init_db
from app.ui.pages_step2 import portfolio_page, show_about_page

# –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
init_db()

# –ü–æ–ª—É—á–∞–µ–º –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –∏–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è
DEV = os.getenv("DEV", "0") == "1"
PORT = int(os.getenv("APP_PORT", "8086"))  # –ò—Å–ø–æ–ª—å–∑—É–µ–º –ø–æ—Ä—Ç 8086 –¥–ª—è –®–∞–≥–∞ 2

# –ì–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ –ø–æ—Ä—Ç—Ñ–µ–ª—è
@ui.page("/")
def index():
    portfolio_page()

# –°—Ç—Ä–∞–Ω–∏—Ü–∞ "–û –ø—Ä–æ–≥—Ä–∞–º–º–µ"
@ui.page("/about")
def about():
    show_about_page()

# –ó–∞–ø—É—Å–∫–∞–µ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
if __name__ == "__main__":
    print("üöÄ –®–∞–≥ 2: –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–æ–ª–Ω–æ–≥–æ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–∞ –≤–≤–æ–¥–∞ —Å–¥–µ–ª–æ–∫")
    print("=" * 60)
    print("‚úÖ –ù–æ–≤—ã–π –¥–∏–∑–∞–π–Ω + –ü–æ–ª–Ω—ã–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª –≤–≤–æ–¥–∞")
    print("‚úÖ –ê–≤—Ç–æ–¥–æ–ø–æ–ª–Ω–µ–Ω–∏–µ –º–æ–Ω–µ—Ç –∏ –±–∏—Ä–∂")
    print("‚úÖ –ö–Ω–æ–ø–∫–∞ '–¢–µ–∫—É—â–∞—è —Ü–µ–Ω–∞' –∏–∑ 5-6 –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤")
    print("‚úÖ –£–ª—É—á—à–µ–Ω–Ω—ã–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏–µ –∫–∞—Ä—Ç–æ—á–∫–∏")
    print("=" * 60)
    print(f"üåê –û—Ç–∫—Ä–æ–π—Ç–µ http://localhost:{PORT} –≤ –±—Ä–∞—É–∑–µ—Ä–µ")
    print("=" * 60)
    
    ui.run(
        host="127.0.0.1",
        port=PORT,
        reload=DEV,
        show=True,
        title="Crypto Portfolio ‚Äî –®–∞–≥ 2: –ü–æ–ª–Ω—ã–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª",
        favicon="üéØ",
    )
